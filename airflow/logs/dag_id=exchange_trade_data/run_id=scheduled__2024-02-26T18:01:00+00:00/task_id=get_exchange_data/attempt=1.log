[2024-02-26T21:19:54.108+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: exchange_trade_data.get_exchange_data scheduled__2024-02-26T18:01:00+00:00 [queued]>
[2024-02-26T21:19:54.267+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: exchange_trade_data.get_exchange_data scheduled__2024-02-26T18:01:00+00:00 [queued]>
[2024-02-26T21:19:54.268+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2024-02-26T21:19:54.492+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): get_exchange_data> on 2024-02-26 18:01:00+00:00
[2024-02-26T21:19:54.512+0000] {standard_task_runner.py:60} INFO - Started process 16401 to run task
[2024-02-26T21:19:54.567+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'exchange_trade_data', 'get_exchange_data', 'scheduled__2024-02-26T18:01:00+00:00', '--job-id', '63', '--raw', '--subdir', 'DAGS_FOLDER/exchange.py', '--cfg-path', '/tmp/tmphcdn00wm']
[2024-02-26T21:19:54.594+0000] {standard_task_runner.py:88} INFO - Job 63: Subtask get_exchange_data
[2024-02-26T21:19:54.963+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:194 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-02-26T21:19:55.350+0000] {task_command.py:423} INFO - Running <TaskInstance: exchange_trade_data.get_exchange_data scheduled__2024-02-26T18:01:00+00:00 [running]> on host e16193345271
[2024-02-26T21:19:57.842+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='exchange_trade_data' AIRFLOW_CTX_TASK_ID='get_exchange_data' AIRFLOW_CTX_EXECUTION_DATE='2024-02-26T18:01:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-02-26T18:01:00+00:00'
[2024-02-26T21:20:22.612+0000] {python.py:201} INFO - Done. Returned value was: None
[2024-02-27T05:41:26.922+0000] {local_task_job_runner.py:211} ERROR - Heartbeat time limit exceeded!
[2024-02-27T05:41:26.938+0000] {process_utils.py:131} INFO - Sending 15 to group 16401. PIDs of all processes in the group: [16401]
[2024-02-27T05:41:26.939+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 16401
[2024-02-27T05:41:26.983+0000] {taskinstance.py:2450} ERROR - Received SIGTERM. Terminating subprocesses.
[2024-02-27T05:41:26.987+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 2336, in _run_raw_task
    self.refresh_from_db(lock_for_update=True, session=session)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1725, in refresh_from_db
    _refresh_from_db(task_instance=self, session=session, lock_for_update=lock_for_update)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 464, in _refresh_from_db
    ti = TaskInstance.get_task_instance(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/api_internal/internal_api_call.py", line 114, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1707, in get_task_instance
    for attempt in run_with_db_retries(logger=cls.logger()):
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 347, in __iter__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1709, in get_task_instance
    return query.with_for_update().one_or_none()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 2850, in one_or_none
    return self._iter().one_or_none()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 2916, in _iter
    result = self.session.execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1720, in execute
    result = compile_state_cls.orm_setup_cursor_result(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/context.py", line 349, in orm_setup_cursor_result
    return loading.instances(result, querycontext)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/loading.py", line 89, in instances
    cursor.close()
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/loading.py", line 69, in instances
    *[
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/loading.py", line 70, in <listcomp>
    query_entity.row_processor(context, cursor)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/orm/context.py", line 2917, in row_processor
    extra_entities = self._extra_entities + (
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 2452, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2024-02-27T05:41:27.148+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=exchange_trade_data, task_id=get_exchange_data, execution_date=20240226T180100, start_date=20240226T211954, end_date=20240227T054127
[2024-02-27T05:41:31.070+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 63 for task get_exchange_data (Task received SIGTERM signal; 16401)
[2024-02-27T05:41:31.380+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=16401, status='terminated', exitcode=1, started='21:19:54') (16401) terminated with exit code 1
